app.controller('NavbarCtrl', ['$scope', '$auth', '$location', '$aside', function($scope, $auth, $location, $aside){
  $scope.loginForm = {};


  // ASIDE
  $scope.asideState = {
    open: false
  };
  
  $scope.openAside = function(position, backdrop) {
    $scope.asideState = {
      open: true,
      position: position
    };
    
    function postClose() {
      $scope.asideState.open = false;
    };
    
    $aside.open({
      templateUrl: "<%= asset_path('directives/aside.html') %>",
      placement: position,
      size: 'sm',
      backdrop: backdrop,
      controller: function($scope, $uibModalInstance) {
        $scope.ok = function(e) {
          $uibModalInstance.close();
          e.stopPropagation();
        };
        $scope.cancel = function(e) {
          $uibModalInstance.dismiss();
          e.stopPropagation();
        };


// check if user is logged in
  $scope.authResponse = $auth.validateUser()
  $scope.authStatus = $scope.authResponse.$$state.status
  
  // GET USERS FIRST NAME
  $scope.fullname = $scope.authResponse.$$state.value.name
  $scope.splitedname = $scope.fullname.split(" ");
  $scope.loginName = $scope.splitedname[0]
  console.log($scope.loginName)

  
  if ($scope.authStatus == 2) {
    $scope.loggedIn = false;  
    console.log($scope.loggedIn);
    console.log($scope.authStatus)
  } else {
    $scope.loggedIn = true;
    console.log($scope.loggedIn);
    console.log($scope.authStatus)
  }
  
  // Logout (may go in nav bar)
  $scope.logout = function(){
    $auth.signOut().
      then(function(response){
        //handle success
        console.log(response);
        $scope.loggedIn = false;
        $location.path('/')
      }).
      catch(function(response){
        //handle error
        console.log(response.data.errors);
      });
  };


  $scope.toggleClass= "inactive"

  $scope.navToggle = function() {

    if ($scope.toggleClass === "inactive") {
      $scope.toggleClass = "toggleClassActive"
      $scope.ttypeCol = "ttypeColActive"
      $scope.posCol = "posColActive"
    }
    else {
      $scope.toggleClass = "inactive";
      $scope.ttypeCol = "inactive"
      $scope.posCol = "inactive"

      };

      console.log($scope.toggleClass)
  };

      }
    }).result.then(postClose, postClose);
  }


$scope.myDash = function() {
  $location.path('/home');
}




}]);

