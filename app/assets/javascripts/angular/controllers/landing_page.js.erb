app.controller('LandingPageCtrl', ['$scope', '$http', '$location', '$auth','$window', '$rootScope','$anchorScroll', function($scope, $http, $location, $auth, $window, $rootScope, $anchorScroll){

  // Turn off alerts by default
  $scope.loginFail = false;


  // redirect to landing page if user is signed in
  $scope.authResponse = $auth.validateUser()
  $scope.authStatus = $scope.authResponse.$$state.status
  if ($scope.authStatus == 1) {
    console.log("hitting")
    $location.path('/home')
  };

  // Sign up
  $scope.registrationForm = {};
  $scope.signup = function(){
    $auth.submitRegistration($scope.registrationForm).
      then(function(response){
        //handle success
        console.log(response);
        $location.path('/home');
        $scope.loggedIn = true;
        $scope.authResponse = $auth.validateUser();
        $scope.loginName = $scope.authResponse.$$state.value.username;
      }).catch(function(response){
        //handle errors
        console.log(response)
      });
  }
  
  // Login
  $scope.loginForm = {};
  $scope.login = function(){
    $auth.submitLogin($scope.loginForm).
      then(function(response){
        //handle success
        console.log(response);
        $scope.loggedIn = true;
        $scope.authResponse = $auth.validateUser();
        $scope.loginName = $scope.authResponse.$$state.value.username;
        $location.path('/home');
      }).catch(function(response){
        //handle errors
        $scope.loginFail = true;
        console.log(response);
      });
  };


    $scope.gotoSignup = function() {
      // set the location.hash to the id of
      // the element you wish to scroll to.
      $location.hash('signup');

      // call $anchorScroll()
      $anchorScroll();
    };


}]);
